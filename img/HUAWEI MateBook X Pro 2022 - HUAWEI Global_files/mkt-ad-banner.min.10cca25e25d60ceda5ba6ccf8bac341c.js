(function(){var $mktAdBanner=$(".mkt-ad-banner");var mktAdBanner={$adUl:$(".mkt-ad-banner .ad-banner-box ul"),scrollTimer:null,delayTimer:null,height:0,total:0,currentTop:0,timeZone:$mktAdBanner.data("timeZone"),speed:$mktAdBanner.data("speed")*1E3||3E3,fontColor:$mktAdBanner.data("fontColor")||"#000",bgBeginColor:$mktAdBanner.data("bgBeginColor")||"",bgEndColor:$mktAdBanner.data("bgEndColor")||"",closeBtnColor:$mktAdBanner.data("closeBtnColor")||"#000",init:function(){this.currentTop=parseInt(this.$adUl.position().top);
this.setRightColor();this.getValidAdData();this.handleClickEvent()},setRightColor:function(){$(".mkt-ad-banner,.mkt-ad-banner .ad-item-link").css("color",this.fontColor);$(".mkt-ad-banner .ad-item-link .icon-arrow").css("borderColor",this.fontColor);$(".mkt-ad-banner .ad-banner-close .icon-bar").css("backgroundColor",this.closeBtnColor);if(document.documentMode>0)$(".mkt-ad-banner .ad-banner-close").addClass("isIE");if(this.bgBeginColor&&!this.bgEndColor)$mktAdBanner.css("background",this.bgBeginColor);
else if(!this.bgBeginColor&&this.bgEndColor)$mktAdBanner.css("background",this.bgEndColor);if(this.bgBeginColor&&this.bgEndColor)$mktAdBanner.removeClass("default-bg")},getValidAdData:function(){var _this=this;var currLocalTime=(new Date).getTime();$.ajax({type:"get",async:false,timeout:3E4,url:"/services/server/time/?_\x3d"+(new Date).getTime(),dataType:"json",success:function(data){currLocalTime=data.timeStamp}});var currSiteTime=currLocalTime+(_this.timeZone-8)*60*60*1E3;var count=0;_this.$adUl.children("li").each(function(){count++;
var startTime=$(this).data("start");var endTime=$(this).data("end");var start=(new Date(startTime.replace(/-/g,"/"))).getTime();var end=(new Date(endTime.replace(/-/g,"/"))).getTime();if(start>currSiteTime||end<currSiteTime)$(this).removeClass("item-valid").addClass("item-invalid")});_this.total=_this.$adUl.children("li.item-valid").length;var cycleTimer=setTimeout(function(){if(count===_this.$adUl.children("li").length){_this.showAdBanner();clearTimeout(cycleTimer)}},100)},showAdBanner:function(){var _this=
this;$mktAdBanner.delay(600).fadeIn(800);setTimeout(function(){$(".mkt-ad-banner .ad-content-box.item-valid .ad-content").each(function(){var itemContentH=$(this).height();_this.height=_this.height>itemContentH?_this.height:itemContentH});if(_this.height>0){_this.height=_this.height+16*2;$(".mkt-ad-banner .ad-banner-box,.mkt-ad-banner .ad-banner-box .ad-content-box").height(_this.height)}},600);if(_this.total>1){var delayTime=1400+3E3;_this.delayTimer=setTimeout(function(){_this.scrollTimer=setInterval(function(){_this.adBannerScroll()},
10)},delayTime);$mktAdBanner.mouseenter(function(){clearInterval(_this.scrollTimer);clearTimeout(_this.delayTimer)});$mktAdBanner.mouseleave(function(){_this.delayTimer=setTimeout(function(){_this.delayAdBannerScroll()},600)})}},delayAdBannerScroll:function(){var _this=this;_this.scrollTimer=setInterval(function(){_this.adBannerScroll()},10)},adBannerScroll:function(){var _this=this;_this.currentTop--;_this.$adUl.css("top",_this.currentTop);if(_this.currentTop===(_this.total-1)*-1*_this.height){var $firstLi=
_this.$adUl.children("li.item-valid:first-child");_this.$adUl.append($firstLi.clone())}if(_this.currentTop===_this.total*-1*_this.height){_this.currentTop=0;_this.$adUl.css("top",_this.currentTop);_this.$adUl.children("li.item-valid:last-child").remove()}if(_this.currentTop%_this.height===0){clearInterval(_this.scrollTimer);clearTimeout(_this.delayTimer);_this.delayTimer=setTimeout(function(){_this.delayAdBannerScroll()},_this.speed)}},handleClickEvent:function(){var _this=this;$(".mkt-ad-banner .ad-item-link").click(function(){var bannerName=
$(this).siblings(".ad-item-txt").text();var pageName=$(this).attr("href");var ga={"clickName":"banner under navi click "+bannerName+" to "+pageName,"clickType":"navigation","pageCategory":pageCategory,"event":"topAdvert","bannerName":"mkt_advertisement_banner_"+bannerName,"bannerPosition":"top","pageName":pageName};window.dataLayer.push(ga)});$(".mkt-ad-banner .ad-banner-close").click(function(){$mktAdBanner.fadeOut(800);clearInterval(_this.scrollTimer);clearTimeout(_this.delayTimer);var ga={"clickName":"banner under navi click Close",
"clickType":"navigation","pageCategory":pageCategory,"event":"topAdvert","bannerName":"Close","bannerPosition":"top"};window.dataLayer.push(ga)})}};$(function(){if(!$mktAdBanner.length)return;mktAdBanner.init()})})();